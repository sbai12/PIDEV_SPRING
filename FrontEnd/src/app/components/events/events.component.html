<!-- ========================= -->
<!-- Trainings Enrolled By Student -->
<!-- ========================= -->
<h3 class="text-center mt-5">Your Enrolled Trainings</h3>
<div class="row">
  <div class="col-md-6" *ngFor="let training of enrolledTrainings">
    <div class="card mb-4 shadow-sm">
      <div class="card-body">
        <h5 class="card-title">{{ training.name }}</h5>
        <p class="fst-italic text-center">{{ training.date }}</p>
        <p>{{ training.description }}</p>
        <p><strong>Duration:</strong> {{ training.duration }} hours</p>
        <p><strong>Max Capacity:</strong> {{ training.maxCapacity }}</p>

        <p><strong>Average Rating:</strong>
          <ng-container *ngIf="training.averageRating !== null; else noRating">
            <app-rating-stars [rating]="training.averageRating" [readOnly]="true"></app-rating-stars>
            <span class="ms-2">({{ training.averageRating }} / 5)</span>
          </ng-container>
          <ng-template #noRating>
            <span>No ratings yet</span>
          </ng-template>
        </p>

        <!-- Show Rating Form Button -->
        <button class="btn btn-outline-success mb-2" (click)="openRatingForm(training.idForm)">
          Rate this Training
        </button>

        <!-- Rating Form -->
        <div *ngIf="selectedTrainingId === training.idForm">
          <form (ngSubmit)="submitRating(training.idForm)" #form="ngForm">
            <!-- Stars input -->
            <label class="form-label" for="rating">Your Rating:</label>
            <app-rating-stars [(rating)]="rating" id="rating"></app-rating-stars>

            <!-- Comment -->
            <div class="form-group mb-2 mt-2">
              <label for="comment">Your Comment:</label>
              <textarea
                id="comment"
                [(ngModel)]="comment"
                name="comment"
                class="form-control"
                rows="3"
                required
              ></textarea>
            </div>

            <button type="submit" class="btn btn-success w-100 mt-2" [disabled]="!form.valid">
              Submit Review
            </button>

            <!-- Display error message if submission fails -->
            <div *ngIf="errorMessage" class="alert alert-danger mt-3">
              {{ errorMessage }}
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ========================= -->
<!-- Other Trainings Available -->
<!-- ========================= -->
<h3 class="text-center mt-5">Other Available Trainings</h3>
<div class="row">
  <div class="col-md-6" *ngFor="let training of otherTrainings">
    <div class="card mb-4 shadow-sm">
      <div class="card-body">
        <h5 class="card-title">{{ training.name }}</h5>
        <p class="fst-italic text-center">{{ training.date }}</p>
        <p>{{ training.description }}</p>
        <p><strong>Duration:</strong> {{ training.duration }} hours</p>
        <p><strong>Max Capacity:</strong> {{ training.maxCapacity }}</p>

        <p><strong>Average Rating:</strong>
          <ng-container *ngIf="training.averageRating !== null; else noRating2">
            <app-rating-stars [rating]="training.averageRating" [readOnly]="true"></app-rating-stars>
            <span class="ms-2">({{ training.averageRating }} / 5)</span>
          </ng-container>
          <ng-template #noRating2>
            <span>No ratings yet</span>
          </ng-template>
        </p>

        <button class="btn btn-primary w-100" (click)="onRegister(training.idForm)">
          Register
        </button>
      </div>
    </div>
  </div>
</div>
